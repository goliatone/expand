#!/usr/bin/env node
"use strict";

require('yargonaut')
  .style('cyan')
  .helpStyle('green.bold')
  .style('yellow', 'required');


var yargs = require('yargs');
var argv = yargs.usage('Usage: $0 <command> [options]')
    .option('c', {
        alias: 'context',
        describe: 'Path to context JSON file',
        type: 'string'
    })
    .option('e', {
        alias: 'engine',
        describe: 'Template engine',
        type: 'string',
        default: 'swig'
    })
    .version( function() {
		return 'cicerone version: ' + require( '../package' ).version;
	})
    .help('h')
    .alias('h', 'help')
    .epilog('MIT License 2015')
    .argv;

//This should be a valid tempalte file
var template = argv._[0];

var context = argv.context;
if(context){
    try {
        var resolve = require('path').resolve;
        context = resolve(context);
        context = require('fs').readFileSync(context, 'utf-8');
        context = JSON.parse(context);
    } catch(e) {console.log(e)}
}

if(!context) context = process.env;

require('../lib/expand')({
    engine: argv.engine,
    template: template,
    context: context
});
